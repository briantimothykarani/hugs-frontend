import{b as f,r as o,u as b,j as t,L as j}from"./index-QLpKP0Lq.js";import{u as y}from"./UseImagePreview-DmGAiiz0.js";import{a as d}from"./axiosInstance-Dcg-dfFk.js";import{g as v}from"./getImageUrl-D6kr0RYg.js";import"./index-ngrFHoWO.js";function I(){const{id:n}=f(),[r,l]=o.useState({username:"",age:"",institution:"",gender:"male",year_of_study:"",about_student:""}),[s,m]=o.useState(null),[i,p]=o.useState(null),c=y(s),g=b();o.useEffect(()=>{n&&d.get(`StudentUpdate/${n}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access")}`}}).then(e=>{l({username:e.data.username,age:e.data.age,institution:e.data.institution,gender:e.data.gender,year_of_study:e.data.year_of_study,about_student:e.data.about_student}),p(e.data.profile_pic??null)}).catch(e=>{console.error("Failed to fetch student data:",e)})},[n]);const x=e=>{if(e.preventDefault(),s&&s.size>2e6)return;const a=new FormData;Object.entries(r).forEach(([u,h])=>a.append(u,h)),s&&a.append("profile_pic",s),d.put(`StudentUpdate/${n}/`,a,{headers:{Authorization:`Bearer ${localStorage.getItem("access")}`,"Content-Type":"multipart/form-data"}}).then(()=>g("/home")).catch(u=>{console.error("Update failed:",u)})};return t.jsx("div",{className:"min-h-screen bg-gradient-to-r from-purple-700 via-blue-800 to-black flex items-center justify-center p-6",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-xl w-full p-8",children:[t.jsx("h2",{className:"text-3xl font-bold text-purple-800 mb-6 text-center",children:"Update Student"}),t.jsxs("form",{onSubmit:x,className:"space-y-5",children:[["username","age","institution","year_of_study","about_student"].map(e=>t.jsxs("div",{children:[t.jsx("label",{htmlFor:e,className:"block text-sm font-semibold text-gray-700 mb-1",children:e.replace("_"," ").replace(/\b\w/g,a=>a.toUpperCase())}),t.jsx("input",{type:e==="age"||e==="year_of_study"?"number":"text",name:e,value:r[e],onChange:a=>l({...r,[e]:a.target.value}),className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-600",required:!0})]},e)),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"gender",className:"block text-sm font-semibold text-gray-700 mb-1",children:"Gender"}),t.jsxs("select",{name:"gender",value:r.gender,onChange:e=>l({...r,gender:e.target.value}),className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-600",required:!0,children:[t.jsx("option",{value:"male",children:"Male"}),t.jsx("option",{value:"female",children:"Female"}),t.jsx("option",{value:"other",children:"Other"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Profile Picture"}),t.jsx("input",{type:"file",accept:"image/*",onChange:e=>{var a;return m(((a=e.target.files)==null?void 0:a[0])??null)}}),(c||i)&&t.jsx("img",{src:c??v(i),alt:"Profile",className:"mt-2 w-24 h-24 object-cover rounded-full"}),t.jsx("p",{className:"text-xs text-gray-500",children:"Max size: 2MB."})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("button",{type:"submit",className:"bg-purple-700 hover:bg-purple-800 text-white px-6 py-2 rounded",children:"Submit"}),t.jsx(j,{to:"/home",className:"text-purple-700 hover:underline",children:"Back"})]})]})]})})}export{I as default};
